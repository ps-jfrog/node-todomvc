{"_id":"stagehand","_rev":"2-740c6077ff8069788bca199bafb9a944","name":"stagehand","dist-tags":{"latest":"1.0.1"},"versions":{"1.0.0":{"name":"stagehand","version":"1.0.0","description":"A type-safe library for communicating between JS processes, workers, or other message-passing boundaries.","main":"lib/index.js","types":"lib/index.d.ts","repository":{"type":"git","url":"https://github.com/dfreeman/stagehand"},"author":{"name":"Dan Freeman","email":"dfreeman@salsify.com"},"license":"MIT","scripts":{"lint":"eslint --ext ts,js .","test":"mocha -r ts-node/register 'tests/**/*.ts'","test:watch":"mocha --watch --watch-extensions ts -r ts-node/register 'tests/**/*.ts'","prepublishOnly":"tsc -p tsconfig.publish.json","postpublish":"rimraf lib"},"engines":{"node":"6.* || 8.* || >= 10.*"},"devDependencies":{"@types/chai":"^4.1.6","@types/debug":"^0.0.31","@types/mocha":"^5.2.5","@types/node":"^10.11.7","chai":"^4.2.0","eslint":"^5.6.1","eslint-config-prettier":"^3.1.0","eslint-plugin-prettier":"^3.0.0","mocha":"^5.2.0","prettier":"^1.14.3","rimraf":"^2.6.2","ts-node":"^7.0.1","typescript":"^3.1.3","typescript-eslint-parser":"^20.0.0"},"dependencies":{"debug":"^4.1.0"},"_id":"stagehand@1.0.0","dist":{"shasum":"79515e2ad3a02c63f8720c7df9b6077ae14276d9","integrity":"sha512-zrXl0QixAtSHFyN1iv04xOBgplbT4HgC8T7g+q8ESZbDNi5uZbMtxLukFVXPJ5Nl7zCYvYcrT3Mj24WYCH93hw==","tarball":"https://registry.npmjs.org/stagehand/-/stagehand-1.0.0.tgz","fileCount":35,"unpackedSize":42737,"npm-signature":"-----BEGIN PGP SIGNATURE-----\r\nVersion: OpenPGP.js v3.0.4\r\nComment: https://openpgpjs.org\r\n\r\nwsFcBAEBCAAQBQJbyMxxCRA9TVsSAnZWagAAEC0P/3HB9qBhBNeJ/yWtJubp\nEByIbay8aTMKwrtabYIgWswpd2CkGktscnAsw0RIUU6gRkzOH+dBG+jMEG3h\nVWGkjZ52GAUUm3oObZhBsLPH9D8Qhof4j8b9uBL9OuC2W6LN4wRDmnAxeafQ\nZcNg8gVNIaHDNmX4nI8EcfY4Mwl66Ig7ooFrwht/d1sHbV5EWVggj/RkjhRJ\nvqUrIzHwLcwNfxOyGEmby41SnlxzBOZJLyHh937IjfUMALlxBkDsdDS0XLZ3\nCDRT6trwLj+slkLJ+hOPaBeCMUCoVbIdkqOxRWtNurJ0xWVKgIjmvnj/jTP5\nKMGHyCZksxU4xPQoXhCnz6sbMuR/XB7AOd9dXCjqZDA6XqBOvgG4tEnvSNdg\n3EgACGITVhQtXdhu3+WXUE5W8qZgwKhaSyRkvxC9SBDNfsPsbUPQ16POikMq\nOZBaUhNsvf1QiL95+tf/whxUrYZQ4cti6vL1Ym0UMxtWrj9lQt50wDv3x2AA\nKp+YJyxByPhuwKwayvr/sWbDln6sbX9r+v1w4LWpAPkEYYmS4tG4mk5vggvU\nNXctdwaqq10aiSdgbcKzuL+hY2Gsippjw9VYobk6hK/1nBDSw383qnkRUmSt\nlRSaHJriK2GAZrK4p512z6/i59QInyxnesXMxj2Hw5sYmTPfllrwhCBk8xbN\nPeIV\r\n=hQZA\r\n-----END PGP SIGNATURE-----\r\n","signatures":[{"keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA","sig":"MEUCIQD0STZgl+uhJkCaX3XcRToB78+nssv0rNnXIq/bNSp2xQIgb4jdILKEdKbTf5n8+yhhLqr/qsHBJEegs0uIY51Jyts="}]},"maintainers":[{"name":"dfreeman","email":"dfreeman@salsify.com"}],"_npmUser":{"name":"dfreeman","email":"dfreeman@salsify.com"},"directories":{},"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/stagehand_1.0.0_1539886192381_0.09994314968532558"},"_hasShrinkwrap":false},"1.0.1":{"name":"stagehand","version":"1.0.1","description":"A type-safe library for communicating between JS processes, workers, or other message-passing boundaries.","main":"lib/index.js","types":"lib/index.d.ts","repository":{"type":"git","url":"https://github.com/dfreeman/stagehand"},"author":{"name":"Dan Freeman","email":"dfreeman@salsify.com"},"license":"MIT","scripts":{"lint":"prettier --check . && eslint .","test":"mocha --expose-gc -r ts-node/register 'tests/**/*.ts'","test:watch":"mocha --watch --watch-extensions ts -r ts-node/register 'tests/**/*.ts'","prepublishOnly":"tsc -p tsconfig.publish.json","postpublish":"rimraf lib"},"engines":{"node":"6.* || 8.* || >= 10.*"},"devDependencies":{"@types/chai":"^4.1.6","@types/debug":"^0.0.31","@types/mocha":"^5.2.5","@types/node":"^12.0.0","@typescript-eslint/parser":"^5.48.0","@typescript-eslint/eslint-plugin":"^5.48.0","chai":"^4.2.0","eslint":"^8.31.0","mocha":"^5.2.0","prettier":"^2.8.1","rimraf":"^2.6.2","ts-node":"^7.0.1","typescript":"^4.9.4"},"dependencies":{"debug":"^4.1.0"},"volta":{"node":"12.22.12","yarn":"1.22.19"},"_id":"stagehand@1.0.1","dist":{"shasum":"0cbca6f906e4a7be36c5830dc31d9cc7091a827e","integrity":"sha512-GqXBq2SPWv9hTXDFKS8WrKK1aISB0aKGHZzH+uD4ShAgs+Fz20ZfoerLOm8U+f62iRWLrw6nimOY/uYuTcVhvg==","tarball":"https://registry.npmjs.org/stagehand/-/stagehand-1.0.1.tgz","fileCount":31,"unpackedSize":34781,"signatures":[{"keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA","sig":"MEYCIQDjUzAwgcl0IpN3R9RrG2kmkddwhvbfDxzQZcZf30VbHQIhAO56PUjibF1sitTQJXcmMW+1bzPKWyY5ryyiAaV8LJd/"}],"npm-signature":"-----BEGIN PGP SIGNATURE-----\r\nVersion: OpenPGP.js v4.10.10\r\nComment: https://openpgpjs.org\r\n\r\nwsFzBAEBCAAGBQJjtERCACEJED1NWxICdlZqFiEECWMYAoorWMhJKdjhPU1b\r\nEgJ2VmpgUxAAgXDbA0Riq27S2Qr/ZJ3ast5R34PU68IVbGIn/ATAwMmjOSTX\r\nC672V/5gGS/S5SlJ9yWlRhBBU5giQRJ/JkUCz88RvfH+Qsj36Je33ywb58sy\r\n15SKt4DkSN6YVvhOG10TeY0a0sXIk8YDlLxf7HWFciOsgztGtdwel+xpghyW\r\nOs54ys8xIOMZmfygFqBK/heggZTSBv2ZvAoaSSgzGgYTn0A5hHnGBKXbb/kJ\r\nb2f1IQz4RBKTHPLpZLH8Y9lNUsqB6ngZbKIlV1l87pfRsyXkaTKkNRkf6MNk\r\nqd9RjfB8/kCtT8SEzsrN+xamwe8L2ML4MewLMKr91nf7RY1z0xT71egxMlQi\r\nTbPd8T0wfKVx/HHsqCBYn4vfTGUbTTi2mHF1JCGYDr0ID4c3iq7nM70Pflpj\r\n7zYMmXlIdNM00+lpXSI9JIYBO1yNs00QSC1C8Lg9OxJNhHc9wT8kIsWGNKe4\r\nr+6uIN5vEYnMsYY1i2JwxKMNSqj9zH1yHRBSH0eUfGMYiEqqXxfZV38MR9ll\r\nvl9hCCJryjszY0/QOPv52YMrZdzoMqYeLU9NGDh3HtGtQBl8DyFWqrGzO37A\r\nfriYJf1bmSHP5vMuesFK1xYUtbA7pc7lcHNwn58dm/NboqAjoBNLeQMIPuFu\r\nu0unoPYNpjYpgAw2WaCI0IQZvLrJvVsBH9I=\r\n=x9Px\r\n-----END PGP SIGNATURE-----\r\n"},"_npmUser":{"name":"dfreeman","email":"dfreeman@salsify.com"},"directories":{},"maintainers":[{"name":"dfreeman","email":"dfreeman@salsify.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/stagehand_1.0.1_1672758337901_0.05634634639978686"},"_hasShrinkwrap":false}},"time":{"created":"2018-10-18T18:09:52.381Z","1.0.0":"2018-10-18T18:09:52.505Z","modified":"2023-01-03T15:05:38.180Z","1.0.1":"2023-01-03T15:05:38.090Z"},"maintainers":[{"name":"dfreeman","email":"dfreeman@salsify.com"}],"description":"A type-safe library for communicating between JS processes, workers, or other message-passing boundaries.","repository":{"type":"git","url":"https://github.com/dfreeman/stagehand"},"author":{"name":"Dan Freeman","email":"dfreeman@salsify.com"},"license":"MIT","readme":"# Stagehand [![CI](https://github.com/dfreeman/stagehand/workflows/CI/badge.svg)](https://github.com/dfreeman/stagehand/actions?query=workflow%3ACI)\n\nStagehand provides a type-safe means of coordinating communication across an evented message-passing boundary, such as a web worker or a Node.js child process.\n\n## Example\n\nThe following is a quick example of how you might spin up a child process in Node to perform expensive computations:\n\n```ts\n// greeting-worker.js\nimport { launch } from 'stagehand/lib/adapters/child-process';\n\nclass GreetingWorker {\n  veryExpensiveGreeting(target) {\n    // The body of this method (and any others defined on the object passed to\n    // `launch`) might be arbitrarily expensive synchronous or async work.\n    return `Hello, ${target}!`;\n  }\n}\n\nlaunch(new GreetingWorker());\n```\n\n```ts\n// main.js\nimport { fork } from 'child_process';\nimport { connect } from 'stagehand/lib/adapters/child-process';\n\nlet worker = await connect(fork('./greeting-worker'));\nlet greeting = await worker.veryExpensiveGreeting('World');\n\nconsole.log(greeting); // 'Hello, World!'\n```\n\n## API\n\nThe main `stagehand` module exports three functions: `launch`, `connect` and `disconnect`. These functions all center around the concept of a `MessageEndpoint`, which is the core interface Stagehand uses for communication.\n\n### `launch<T>(endpoint: MessageEndpoint, implementation: Implementation<T>)`\n\nThis function is called to expose a backing implementation object across the given endpoint. Typically you'll call this from your child process/web worker/otherwise-somehow-secondary context in order to begin servicing commands from the parent.\n\nIn general, all functions on the implementation object passed to `launch` will be exposed on the corresponding object on the `connect` side, but made async where appropriate. This means that all return values from methods on `implementation` will be promises, but also that functions _passed in_ to methods on the backing implementation will be asynchronous as well.\n\nIf you're using TypeScript, you'll find this invariant enforced by the signature of `launch`, i.e.\n\n```ts\n// This is valid:\nlaunch(endpoint, {\n  doSomething(callback: () => Promise<number>) {\n    // Because `callback` is async, can communicate back to the parent when\n    // called in order to get the return value\n  },\n});\n\n// But this is not:\nlaunch(endpoint, {\n  doSomething(callback: () => number) {\n    // There's no way for `callback` to synchronously get a return value\n    // from the function originally passed on the parent side\n  },\n});\n```\n\n### `connect<T>(endpoint: MessageEndpoint): Promise<Remote<T>>`\n\nThis function is called to connect to a backing implementation that was set up on the other end of the given message endpoint. It returns a promise that will ultimately resolve to a value that exposes the same methods as the backing implementation.\n\nWhen calling these methods, their results will always be promises that resolve or reject based on the return value or thrown execption when that method is called on the implementation side.\n\n### `disconnect<T>(remote: Remote<T>)`\n\nDisconnects the given stagehand worker, clearing any saved state on both ends and calling `disconnect` on both halves of the corresponding `MessageEndpoint`.\n\n### `MessageEndpoint`\n\nA `MessageEndpoint` is any object with the following three methods:\n\n- `onMessage(callback: (message: unknown) => void): void`\n- `sendMessage(message: unknown): void`\n- `disconnect(): void`\n\nSeveral adapters for converting common communication objects to this type are included in this library:\n\n- `stagehand/lib/adapters/child-process` creates endpoints for communicating to/from processes spawned with Node.js's [`fork`](https://nodejs.org/api/child_process.html#child_process_child_process_fork_modulepath_args_options) (see the example above)\n- `stagehand/lib/adapters/web-worker` creates endpoints for communicating to /from [web workers](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API)\n- `stagehand/lib/adapters/in-memory` create endpoints from scratch that both exist within the same process (mostly useful for testing)\n\nThese adapter modules also generally expose specialized versions of `launch` and `connect` that accept appropriate objects for the domain they deal with and internally convert them using the endpoint adapters also defined there.\n","readmeFilename":"README.md"}